BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "Compra" (
	"nro_tarjeta"	INTEGER,
	"rubro"	TEXT NOT NULL,
	"fecha_compra"	DATE NOT NULL,
	"monto"	DECIMAL NOT NULL,
	FOREIGN KEY("nro_tarjeta") REFERENCES "Tarjeta"("nro_tarjeta")
);
CREATE TABLE IF NOT EXISTS "Persona" (
	"id"	INTEGER,
	"nombre"	TEXT NOT NULL,
	"dni"	INTEGER NOT NULL UNIQUE,
	"fecha_nacimiento"	DATE NOT NULL,
	"id_padre"	INTEGER,
	"sexo"	TEXT NOT NULL,
	PRIMARY KEY("id"),
	FOREIGN KEY("id_padre") REFERENCES "Persona"("id")
);
CREATE TABLE IF NOT EXISTS "Tarjeta" (
	"nro_tarjeta"	INTEGER,
	"id_titular"	INTEGER NOT NULL,
	"fecha_vencimiento"	DATE NOT NULL,
	PRIMARY KEY("nro_tarjeta"),
	FOREIGN KEY("id_titular") REFERENCES "Persona"("id")
);
INSERT INTO "Compra" VALUES (1001,'Supermercado','2025-05-01',150.75);
INSERT INTO "Compra" VALUES (1002,'Electrónica','2025-04-28',899.99);
INSERT INTO "Compra" VALUES (1004,'Farmacia','2025-05-05',168.75);
INSERT INTO "Compra" VALUES (1004,'Supermercado','2025-05-07',5800.35);
INSERT INTO "Compra" VALUES (1005,'Supermercado','2025-05-07',4500.35);
INSERT INTO "Compra" VALUES (1005,'Farmacia','2025-05-07',3000.35);
INSERT INTO "Compra" VALUES (1008,'Supermercado','2025-05-10',3000);
INSERT INTO "Compra" VALUES (1008,'Farmacia','2025-05-11',2500);
INSERT INTO "Compra" VALUES (1011,'Supermercado','2025-05-12',4800);
INSERT INTO "Compra" VALUES (1014,'Farmacia','2025-05-03',2600);
INSERT INTO "Compra" VALUES (1014,'Supermercado','2025-05-03',2700);
INSERT INTO "Compra" VALUES (1015,'Farmacia','2025-05-10',1500);
INSERT INTO "Compra" VALUES (1015,'Supermercado','2025-05-10',2000);
INSERT INTO "Compra" VALUES (1016,'Supermercado','2025-05-11',5000);
INSERT INTO "Compra" VALUES (1017,'Farmacia','2025-05-05',5200);
INSERT INTO "Compra" VALUES (1018,'Farmacia','2025-05-07',3000);
INSERT INTO "Compra" VALUES (1018,'Supermercado','2025-05-07',3000);
INSERT INTO "Compra" VALUES (1019,'Supermercado','2025-05-02',1000);
INSERT INTO "Compra" VALUES (1020,'Farmacia','2025-05-03',2000);
INSERT INTO "Compra" VALUES (1020,'Supermercado','2025-05-04',4000);
INSERT INTO "Compra" VALUES (1021,'Farmacia','2025-05-06',4900);
INSERT INTO "Compra" VALUES (1021,'Supermercado','2025-05-06',150);
INSERT INTO "Compra" VALUES (1022,'Farmacia','2025-04-30',6000);
INSERT INTO "Compra" VALUES (1022,'Supermercado','2025-05-01',5000);
INSERT INTO "Compra" VALUES (1023,'Farmacia','2025-05-03',1000);
INSERT INTO "Compra" VALUES (1023,'Supermercado','2025-05-04',4500);
INSERT INTO "Compra" VALUES (1024,'Farmacia','2025-05-08',2500);
INSERT INTO "Compra" VALUES (1024,'Supermercado','2025-05-09',2600);
INSERT INTO "Compra" VALUES (1025,'Farmacia','2025-05-10',3000);
INSERT INTO "Compra" VALUES (1025,'Supermercado','2025-05-11',2000);
INSERT INTO "Compra" VALUES (1026,'Supermercado','2025-05-12',1000);
INSERT INTO "Compra" VALUES (1027,'Farmacia','2025-05-02',3000);
INSERT INTO "Compra" VALUES (1028,'Farmacia','2025-05-03',2500);
INSERT INTO "Compra" VALUES (1028,'Supermercado','2025-05-03',3000);
INSERT INTO "Compra" VALUES (1029,'Farmacia','2025-05-10',1000);
INSERT INTO "Compra" VALUES (1029,'Supermercado','2025-05-10',1200);
INSERT INTO "Compra" VALUES (1030,'Farmacia','2025-05-15',3100);
INSERT INTO "Compra" VALUES (1030,'Supermercado','2025-05-15',3500);
INSERT INTO "Compra" VALUES (1031,'Farmacia','2025-05-16',2800);
INSERT INTO "Compra" VALUES (1031,'Supermercado','2025-05-16',2200);
-- Personas sin padre (id_padre = NULL)
INSERT INTO "Persona" VALUES (4,'Leon Gonzalez',38592369,'1930-10-15',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (5,'Marta Díaz',45678901,'1980-02-20',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (7,'Carmen López',67890123,'1995-05-10',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (9,'Diego Martínez',89012345,'1975-04-12',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (11,'Pedro Alvarez',10000011,'1985-01-15',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (12,'Luisa Ramirez',10000012,'1990-06-25',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (13,'Nicolas Suarez',10000013,'1975-08-05',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (14,'Verónica Díaz',10000014,'1982-11-11',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (17,'Matias Blanco',10000017,'1988-09-30',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (18,'Sabrina Soto',10000018,'1993-10-12',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (21,'Carlos Rivas',10000021,'1972-05-25',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (22,'Micaela Gutierrez',10000022,'1987-12-09',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (24,'Claudia Peña',10000024,'1979-07-27',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (25,'Mario Chávez',10000025,'1965-02-05',NULL,'MASCULINO');
INSERT INTO "Persona" VALUES (28,'Luciana Ferreyra',10000028,'1994-10-28',NULL,'FEMENINO');
INSERT INTO "Persona" VALUES (29,'Ricardo Castro',10000029,'1992-03-22',NULL,'MASCULINO');

-- Personas con padre ya insertado
INSERT INTO "Persona" VALUES (3,'Luis Gómez',34567890,'1950-11-30',4,'MASCULINO');
INSERT INTO "Persona" VALUES (2,'Ana Pérez',23456789,'1970-07-15',3,'FEMENINO');
INSERT INTO "Persona" VALUES (1,'Carlos Pérez',12345678,'2000-03-21',2,'MASCULINO');
INSERT INTO "Persona" VALUES (6,'Jorge Díaz',56789012,'2002-09-25',5,'MASCULINO');
INSERT INTO "Persona" VALUES (8,'Lucía López',78901234,'2020-01-01',7,'FEMENINO');
INSERT INTO "Persona" VALUES (10,'Sofía Martínez',90123456,'2005-08-22',9,'FEMENINO');
INSERT INTO "Persona" VALUES (15,'Tomas Herrera',10000015,'2000-03-03',11,'MASCULINO');
INSERT INTO "Persona" VALUES (16,'Elena Rojas',10000016,'1999-07-18',12,'FEMENINO');
INSERT INTO "Persona" VALUES (19,'Federico Varela',10000019,'2001-01-21',13,'MASCULINO');
INSERT INTO "Persona" VALUES (20,'Romina Tevez',10000020,'2002-04-04',14,'FEMENINO');
INSERT INTO "Persona" VALUES (23,'Agustín Luna',10000023,'1995-03-17',21,'MASCULINO');
INSERT INTO "Persona" VALUES (27,'Pablo Giménez',10000027,'2003-09-09',22,'MASCULINO');
INSERT INTO "Persona" VALUES (26,'Nora Medina',10000026,'1996-06-06',24,'FEMENINO');
INSERT INTO "Persona" VALUES (30,'Daniela Morales',10000030,'1991-08-16',28,'FEMENINO');
INSERT INTO "Tarjeta" VALUES (1001,2,'2027-06-30');
INSERT INTO "Tarjeta" VALUES (1002,1,'2026-12-31');
INSERT INTO "Tarjeta" VALUES (1003,3,'2025-09-15');
INSERT INTO "Tarjeta" VALUES (1004,3,'2025-08-03');
INSERT INTO "Tarjeta" VALUES (1005,4,'2025-10-09');
INSERT INTO "Tarjeta" VALUES (1006,4,'2025-10-09');
INSERT INTO "Tarjeta" VALUES (1007,5,'2026-11-30');
INSERT INTO "Tarjeta" VALUES (1008,6,'2026-10-15');
INSERT INTO "Tarjeta" VALUES (1009,7,'2025-12-01');
INSERT INTO "Tarjeta" VALUES (1010,8,'2027-01-01');
INSERT INTO "Tarjeta" VALUES (1011,9,'2026-05-01');
INSERT INTO "Tarjeta" VALUES (1012,10,'2026-08-01');
INSERT INTO "Tarjeta" VALUES (1013,6,'2026-12-31');
INSERT INTO "Tarjeta" VALUES (1014,11,'2026-09-30');
INSERT INTO "Tarjeta" VALUES (1015,12,'2026-07-31');
INSERT INTO "Tarjeta" VALUES (1016,13,'2027-01-15');
INSERT INTO "Tarjeta" VALUES (1017,14,'2025-10-20');
INSERT INTO "Tarjeta" VALUES (1018,15,'2026-11-01');
INSERT INTO "Tarjeta" VALUES (1019,16,'2026-05-05');
INSERT INTO "Tarjeta" VALUES (1020,17,'2027-03-03');
INSERT INTO "Tarjeta" VALUES (1021,18,'2026-12-12');
INSERT INTO "Tarjeta" VALUES (1022,19,'2025-06-06');
INSERT INTO "Tarjeta" VALUES (1023,20,'2026-04-04');
INSERT INTO "Tarjeta" VALUES (1024,21,'2026-08-08');
INSERT INTO "Tarjeta" VALUES (1025,22,'2027-02-02');
INSERT INTO "Tarjeta" VALUES (1026,23,'2025-12-25');
INSERT INTO "Tarjeta" VALUES (1027,24,'2026-06-06');
INSERT INTO "Tarjeta" VALUES (1028,25,'2026-10-10');
INSERT INTO "Tarjeta" VALUES (1029,26,'2025-09-09');
INSERT INTO "Tarjeta" VALUES (1030,27,'2026-01-01');
INSERT INTO "Tarjeta" VALUES (1031,28,'2027-07-07');
INSERT INTO "Tarjeta" VALUES (1032,29,'2026-03-03');
INSERT INTO "Tarjeta" VALUES (1033,30,'2025-11-11');
CREATE INDEX IF NOT EXISTS "idx_compra_fecha_rubro_monto_nro" ON "Compra" (
	"fecha_compra",
	"rubro",
	"monto",
	"nro_tarjeta"
);
CREATE INDEX IF NOT EXISTS "idx_compra_nro_fecha" ON "Compra" (
	"nro_tarjeta",
	"fecha_compra"
);
CREATE INDEX IF NOT EXISTS "idx_tarjeta_id_titular" ON "Tarjeta" (
	"id_titular"
);

COMMIT;
